---
import LayoutSidebar from '../layouts/LayoutSidebar.astro';
import { Card } from 'flowbite-react';

// Mock data for eco metrics
const ecoMetrics = {
  carbonOffset: {
    current: 2547,
    previous: 2100,
    unit: 'tons',
    change: 21.3
  },
  waterSaved: {
    current: 156000,
    previous: 145000,
    unit: 'gallons',
    change: 7.6
  },
  renewableEnergy: {
    current: 45.8,
    previous: 42.1,
    unit: 'MWh',
    change: 8.8
  },
  wasteRecycled: {
    current: 89.5,
    previous: 82.3,
    unit: '%',
    change: 8.7
  }
};

// Mock data for recent media uploads
const recentMedia = [
  {
    id: 1,
    title: 'Solar Installation Project',
    type: 'video',
    size: '24.5 MB',
    date: '2024-03-07',
    views: 1234,
    impact: 'High',
    category: 'Renewable Energy'
  },
  {
    id: 2,
    title: 'Community Garden Initiative',
    type: 'image',
    size: '3.2 MB',
    date: '2024-03-06',
    views: 856,
    impact: 'Medium',
    category: 'Agriculture'
  },
  {
    id: 3,
    title: 'Water Conservation Report',
    type: 'document',
    size: '1.8 MB',
    date: '2024-03-05',
    views: 567,
    impact: 'High',
    category: 'Water'
  }
];
---

<LayoutSidebar title="Eco Operations Media Dashboard">
  <div class="px-4 pt-6">
    <!-- Metrics Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
      <!-- Carbon Offset Metric -->
      <div class="bg-white rounded-lg shadow p-4 sm:p-6 xl:p-8">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <span class="text-2xl sm:text-3xl leading-none font-bold text-gray-900">
              {ecoMetrics.carbonOffset.current.toLocaleString()}
            </span>
            <h3 class="text-base font-normal text-gray-500">Carbon Offset</h3>
          </div>
          <div class="ml-5 w-0 flex items-center justify-end flex-1">
            <span class={`text-sm font-bold ${ecoMetrics.carbonOffset.change > 0 ? 'text-green-500' : 'text-red-500'}`}>
              {ecoMetrics.carbonOffset.change}%
            </span>
          </div>
        </div>
      </div>

      <!-- Water Saved Metric -->
      <div class="bg-white rounded-lg shadow p-4 sm:p-6 xl:p-8">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <span class="text-2xl sm:text-3xl leading-none font-bold text-gray-900">
              {ecoMetrics.waterSaved.current.toLocaleString()}
            </span>
            <h3 class="text-base font-normal text-gray-500">Water Saved (Gallons)</h3>
          </div>
          <div class="ml-5 w-0 flex items-center justify-end flex-1">
            <span class={`text-sm font-bold ${ecoMetrics.waterSaved.change > 0 ? 'text-green-500' : 'text-red-500'}`}>
              {ecoMetrics.waterSaved.change}%
            </span>
          </div>
        </div>
      </div>

      <!-- Renewable Energy Metric -->
      <div class="bg-white rounded-lg shadow p-4 sm:p-6 xl:p-8">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <span class="text-2xl sm:text-3xl leading-none font-bold text-gray-900">
              {ecoMetrics.renewableEnergy.current}
            </span>
            <h3 class="text-base font-normal text-gray-500">Renewable Energy (MWh)</h3>
          </div>
          <div class="ml-5 w-0 flex items-center justify-end flex-1">
            <span class={`text-sm font-bold ${ecoMetrics.renewableEnergy.change > 0 ? 'text-green-500' : 'text-red-500'}`}>
              {ecoMetrics.renewableEnergy.change}%
            </span>
          </div>
        </div>
      </div>

      <!-- Waste Recycled Metric -->
      <div class="bg-white rounded-lg shadow p-4 sm:p-6 xl:p-8">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <span class="text-2xl sm:text-3xl leading-none font-bold text-gray-900">
              {ecoMetrics.wasteRecycled.current}%
            </span>
            <h3 class="text-base font-normal text-gray-500">Waste Recycled</h3>
          </div>
          <div class="ml-5 w-0 flex items-center justify-end flex-1">
            <span class={`text-sm font-bold ${ecoMetrics.wasteRecycled.change > 0 ? 'text-green-500' : 'text-red-500'}`}>
              {ecoMetrics.wasteRecycled.change}%
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Media Content Section -->
    <div class="grid grid-cols-1 xl:grid-cols-2 gap-4">
      <!-- Recent Uploads -->
      <div class="bg-white rounded-lg shadow p-4 sm:p-6 xl:p-8">
        <div class="mb-4 flex items-center justify-between">
          <h3 class="text-xl font-bold text-gray-900">Recent Media Uploads</h3>
          <a href="#" class="text-sm font-medium text-cyan-600 hover:bg-gray-100 rounded-lg p-2">View all</a>
        </div>
        <div class="flex flex-col mt-8">
          <div class="overflow-x-auto">
            <div class="align-middle inline-block min-w-full">
              <div class="overflow-hidden">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th scope="col" class="p-4 text-left text-xs font-medium text-gray-500 uppercase">Title</th>
                      <th scope="col" class="p-4 text-left text-xs font-medium text-gray-500 uppercase">Category</th>
                      <th scope="col" class="p-4 text-left text-xs font-medium text-gray-500 uppercase">Views</th>
                      <th scope="col" class="p-4 text-left text-xs font-medium text-gray-500 uppercase">Impact</th>
                    </tr>
                  </thead>
                  <tbody class="bg-white">
                    {recentMedia.map((item) => (
                      <tr>
                        <td class="p-4 whitespace-nowrap text-sm font-normal text-gray-900">
                          <span class="font-semibold">{item.title}</span>
                        </td>
                        <td class="p-4 whitespace-nowrap text-sm text-gray-500">{item.category}</td>
                        <td class="p-4 whitespace-nowrap text-sm text-gray-500">{item.views}</td>
                        <td class="p-4 whitespace-nowrap">
                          <span class={`px-2 py-1 rounded-full text-xs font-medium 
                            ${item.impact === 'High' ? 'bg-green-100 text-green-800' : 
                              item.impact === 'Medium' ? 'bg-yellow-100 text-yellow-800' : 
                              'bg-gray-100 text-gray-800'}`}>
                            {item.impact}
                          </span>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Upload Section -->
      <div class="bg-white rounded-lg shadow p-4 sm:p-6 xl:p-8">
        <div class="mb-4">
          <h3 class="text-xl font-bold text-gray-900 mb-2">Upload New Media</h3>
          <p class="text-sm text-gray-500">Share your eco-impact through media</p>
        </div>
        <form class="space-y-4">
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-900" for="file_input">Upload file</label>
            <input class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none" id="file_input" type="file">
          </div>
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-900" for="title">Title</label>
            <input type="text" id="title" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5" required>
          </div>
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-900" for="category">Category</label>
            <select id="category" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
              <option>Renewable Energy</option>
              <option>Water Conservation</option>
              <option>Waste Management</option>
              <option>Agriculture</option>
              <option>Education</option>
            </select>
          </div>
          <div>
            <label class="block mb-2 text-sm font-medium text-gray-900" for="description">Description</label>
            <textarea id="description" rows="3" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-cyan-600 focus:border-cyan-600"></textarea>
          </div>
          <button type="submit" class="text-white bg-cyan-600 hover:bg-cyan-700 focus:ring-4 focus:ring-cyan-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center w-full">Upload Media</button>
        </form>
      </div>
    </div>
  </div>
</LayoutSidebar>

<script>
  // Add interactivity here
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.querySelector('form');
    form?.addEventListener('submit', (e) => {
      e.preventDefault();
      // Add upload logic here
    });
  });
</script>
